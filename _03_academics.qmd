---
title-meta: academics
execute:
  warning: false
  echo: false
  message: false
format:
  typst:
    keep-typ: true
  pdf:
    keep-md: true
    keep-tex: true
  html: 
    toc: true
params:
  pheno: academics
---

<!-- ## Academic Skills -->

{{< include _03_academics_text.qmd >}}

```{r}
#| label: data-academics
data <- bwu::read_data(pheno = "academics")
```

```{r}
#| label: filter-academics
domains <- c("Academic Skills")
scales <- c(
  "Academic Fluency Composite",
  "Academic Language Readiness Index",
  "Academic Skills Battery (ASB) Composite",
  "Alphabet Writing Fluency",
  "Associational Fluency",
  "Basic Reading",
  "Comprehension Composite",
  "Decoding Composite",
  "Decoding Fluency",
  "Decoding",
  "Dyslexia Index",
  "Essay Composition",
  "Expression Composite",
  "Expressive Vocabulary",
  "Letter & Word Recognition",
  "Letter Naming Facility",
  "Listening Comprehension",
  "Math Composite",
  "Math Computation",
  "Math Concepts & Applications",
  "Math Fluency-Addition",
  "Math Fluency-Multiplication",
  "Math Fluency-Subtraction",
  "Math Fluency",
  "Math Problem Solving",
  "Mathematics",
  "Nonsense Word Decoding",
  "Numerical Operations",
  "Object Naming Facility",
  "Oral Discourse Comprehension",
  "Oral Expression",
  "Oral Fluency Composite",
  "Oral Language Composite",
  "Oral Reading Fluency",
  "Oral Word Fluency",
  "Orthographic Choice",
  "Orthographic Fluency",
  "Orthographic Processing Composite",
  "Orthographic Processing Extended",
  "Orthographic Processing",
  "Phonemic Proficiency",
  "Phonological Processing",
  "Pseudoword Decoding",
  "Reading Composite",
  "Reading Comprehension",
  "Reading Comprehension",
  "Reading Fluency Composite",
  "Reading Fluency",
  "Reading Index",
  "Reading Understanding Composite",
  "Reading Vocabulary",
  "Reading",
  "Receptive Vocabulary",
  "Sentence Composition",
  "Sentence Comprehension",
  "Sentence Repetition",
  "Sentence Writing Fluency",
  "Silent Reading Fluency",
  "Sound-Symbol Composite",
  "Spelling",
  "Total Achievement",
  "Word Reading",
  "Word Recognition Fluency",
  "Writing Fluency",
  "Written Expression",
  "Written Language Composite"
)
data <- bwu::filter_domain_scale(data, domain = domains, scale = scales)
```

```{r}
#| label: text-academics
#| cache: true
bwu::flatten_scale_text(data, file = "_03_academics_raw.qmd")
```

```{r}
#| label: qtbl-academics
#| dev: tikz
#| fig-process: pdf2png
options(tikzDefaultEngine = "xetex")
source_note <- "*Note:* Index scores have a mean of 100 and a standard deviation of 15."
table_name <- "table_academics"
pheno <- "academics"
bwu::make_tbl_gt(data, pheno = pheno, source_note = source_note, table_name = table_name)
```


```{=typst}
#let domain = "Academic Skills"
<qtbl-academics>
#figure([#image("table_academics.png", width: 50%)],
  caption: [
    #domain Test Scores
  ],
  kind: "qtbl",
  supplement: [Table],
)
```

```{r}
#| label: fig-academics
#| out-width: 70%
#| fig-cap: "_Reading ability_ consists of three interrelated abilities: decoding, comprehension, and fluency. _Writing ability_ can be described in terms of spelling, grammar, expression of ideas, and writing fluency. _Math ability_ can be described in terms of calculation skills, applied problem solving, and math fluency."
#| column: page

roma <- c( '#7E1700', '#832504', '#883008', '#8E3B0B', '#92450F', '#984E14', '#9C5717', '#A05F1B', '#A4671E', '#A86F22', '#AD7826', '#B0802B', '#B58A30', '#B99336', '#BD9C3D', '#C2A647', '#C7B051', '#CBBA5D', '#CEC56C', '#D0CE7A', '#D2D78A', '#D1DE98', '#CFE4A6', '#CBE7B3', '#C4EABD', '#BCEAC6', '#B2E8CD', '#A7E6D2', '#9BE2D4', '#8EDDD7', '#80D6D7', '#73CED5', '#65C6D5', '#59BDD2', '#4FB5D0', '#45ABCB', '#3DA3C8', '#379BC5', '#3292C2', '#2E8ABF', '#2A81BA', '#2779B7', '#2471B4', '#2269B0', '#1F60AD', '#1B57A8', '#184EA4', '#1344A0', '#0C3B9C', '#023198' )

pheno <- "academics"
academics <- dplyr::filter(data, !is.na(percentile))

bwu::make_fig(
  data = academics,
  pheno = pheno,
  x = academics$z_mean_subdomain,
  y = academics$subdomain,
  colors = roma
)
```
