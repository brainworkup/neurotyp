---
title-meta: motor
execute:
  warning: false
  echo: false
  message: false
format:
  typst:
    keep-typ: true
  pdf:
    keep-md: true
    keep-tex: true
  html: 
    toc: true
params:
  pheno: motor
---

<!-- ## Motor -->

{{< include _08_motor_text.qmd >}}

```{r}
#| label: data-motor
data <- bwu::read_data(pheno = "motor")
```

```{r}
#| label: filter-motor

domains <- c("Motor")

scales <- c(
  "Dominant Hand Time",
  "Dominant Hand",
  "Dominant vs. Nondominant",
  "Fingertip Tapping Dominant Hand Repetitions",
  "Fingertip Tapping Dominant Hand Sequences",
  "Fingertip Tapping Dominant Hand",
  "Fingertip Tapping Dominant Hand",
  "Fingertip Tapping Nondominant Hand Repetitions",
  "Fingertip Tapping Nondominant Hand Sequences",
  "Fingertip Tapping Nondominant Hand",
  "Fingertip Tapping Nondominant Hand",
  "Fingertip Tapping Repetitions",
  "Fingertip Tapping Repetitions",
  "Fingertip Tapping Sequences",
  "Fingertip Tapping Sequences",
  "FT Dominant Hand vs. Nondominant Hand",
  "Imitating Hand Positions-Dominant",
  "Imitating Hand Positions-Nondominant",
  "Imitating Hand Positions",
  "Left-Hand Time",
  "Non-Dominant Hand Time",
  "Nondominant Hand",
  "Repetitions vs. Sequences",
  "Right-Hand Time",
  "Visuomotor Precision Errors",
  "Visuomotor Precision Pencil Lifts",
  "Visuomotor Precision Time",
  "Visuomotor Precision"
)

data <- bwu::filter_domain_scale(data, domain = domains, scale = scales)
```

```{r}
#| label: text-motor
#| cache: true

bwu::flatten_scale_text(data, file = "_08_motor_raw.qmd")
```

```{r}
#| label: qtbl-motor
#| dev: tikz
#| fig-process: pdf2png

options(tikzDefaultEngine = "xetex")
source_note <- gt::md("*Note:* T-scores (Mean = 50, SD = 10), Scaled scores (Mean =
10, SD = 3).")
table_name <- "table_motor"
pheno <- "motor"
bwu::make_tbl_gt(data, pheno = pheno, source_note = source_note, table_name = table_name)
```


```{=typst}
#let domain = "Motor"
<qtbl-motor>
#figure([#image("table_motor.png", width: 50%)],
  caption: [
    #domain Test Scores
  ],
  kind: "qtbl",
  supplement: [Table],
)
```

```{r}
#| label: fig-motor
#| fig-cap: "Sensorimotor tasks refer to the capacity to control hand movements quickly, smoothly, and with adequate precision, which are required to engage in activities such as writing and drawing."

pheno <- "motor"
motor <- dplyr::filter(data, !is.na(percentile))

bwu::make_dotplot_typ(
  data = motor,
  pheno = pheno,
  x = motor$z_mean_narrow,
  y = motor$narrow,
  colors = roma
)
```

```{=typst}
#let domain(title: none, file_qtbl, file_fig) = {
  let font = (font: "Inria Serif", size: 9pt)
  set text(..font)
  grid(
  columns: (50%, 50%),
  gutter: 8pt,
figure([#image(file_qtbl)],
  caption: [
    #title
  ],
  caption-pos: top,
  kind: "qtbl",
  supplement: [*Table*],
),
figure(
  placement: bottom,
  caption: [
    Sensorimotor tasks refer to the capacity to control hand movements quickly, smoothly, and with adequate precision, which are required to engage in activities such as writing and drawing.
  ],
  kind: "image",
  supplement: [
    *Figure*
    ],
  gap: 1em,
  [
   #image(file_fig)
   ],
),
)
}
```

```{=typst}
#let file_qtbl = "table_motor.png"
#let file_fig = "_08_motor_files/figure-typst/fig-motor-1.svg"
#domain(
  title: "Motor Test Scores",
  file_qtbl,
  file_fig
)
```
