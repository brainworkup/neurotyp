## Academic Skills {#sec-academics}

{{< include _02-02_academics_text.qmd >}}

```{r}
#| label: data-academics
#| include: false

library(bwu)
library(tidyverse)
library(gt)

data <- bwu::read_data(pheno = "academics")
domains <- c("Academic Skills")
scales <- c(
  "Academic Fluency Composite",
  "Academic Language Readiness Index",
  "Academic Skills Battery (ASB) Composite",
  "Alphabet Writing Fluency",
  "Associational Fluency",
  "Basic Reading",
  "Comprehension Composite",
  "Decoding Composite",
  "Decoding Fluency",
  "Decoding",
  "Dyslexia Index",
  "Essay Composition",
  "Expression Composite",
  "Expressive Vocabulary",
  "Letter & Word Recognition",
  "Letter Naming Facility",
  "Listening Comprehension",
  "Math Composite",
  "Math Computation",
  "Math Concepts & Applications",
  "Math Fluency-Addition",
  "Math Fluency-Multiplication",
  "Math Fluency-Subtraction",
  "Math Fluency",
  "Math Problem Solving",
  "Mathematics",
  "Nonsense Word Decoding",
  "Numerical Operations",
  "Object Naming Facility",
  "Oral Discourse Comprehension",
  "Oral Expression",
  "Oral Fluency Composite",
  "Oral Language Composite",
  "Oral Reading Fluency",
  "Oral Word Fluency",
  "Orthographic Choice",
  "Orthographic Fluency",
  "Orthographic Processing Composite",
  "Orthographic Processing Extended",
  "Orthographic Processing",
  "Phonemic Proficiency",
  "Phonological Processing",
  "Pseudoword Decoding",
  "Reading Composite",
  "Reading Comprehension",
  "Reading Comprehension",
  "Reading Fluency Composite",
  "Reading Fluency",
  "Reading Index",
  "Reading Understanding Composite",
  "Reading Vocabulary",
  "Reading",
  "Receptive Vocabulary",
  "Sentence Composition",
  "Sentence Comprehension",
  "Sentence Repetition",
  "Sentence Writing Fluency",
  "Silent Reading Fluency",
  "Sound-Symbol Composite",
  "Spelling",
  "Total Achievement",
  "Word Reading",
  "Word Recognition Fluency",
  "Writing Fluency",
  "Written Expression",
  "Written Language Composite"
)
data_academics <- bwu::filter_data(data, domain = domains, scale = scales)
```

```{r}
#| label: text-academics
#| cache: true
#| include: false

bwu::cat_neuropsych_results(data = data_academics, file = "_02-02_academics_text.qmd")
```

```{r}
#| label: qtbl-academics
#| dev: tikz
#| fig-process: pdf2png
#| include: false
options(tikzDefaultEngine = "xetex")

# footnotes
fn_standard_score <- gt::md("Index Score: Mean = 100 [50th‰], SD ± 15 [16th‰, 84th‰]")

data <- data_academics
pheno <- "academics"
table_name <- "table_academics"

grp_academics <- list(
  standard_score = c("KTEA-3", "WIAT-4", "WRAT-5")
)
vertical_padding <- 0
multiline <- TRUE

bwu::tbl_gt(
  data = data,
  pheno = pheno,
  table_name = table_name,
  fn_standard_score = fn_standard_score,
  grp_standard_score = grp_academics[["standard_score"]],
  dynamic_grp = grp_academics,
  vertical_padding = vertical_padding,
  multiline = multiline
)
```

```{r}
#| label: fig-academics
#| include: false
#| fig-cap: "_Reading ability_ consists of three interrelated abilities: decoding, comprehension, and fluency. _Writing ability_ can be described in terms of spelling, grammar, expression of ideas, and writing fluency. _Math ability_ can be described in terms of calculation skills, applied problem solving, and math fluency."

# Arguments
pheno <- "academics"
academics <- dplyr::filter(data)
data <- data_academics
x <- data$z_mean_subdomain
y <- data$subdomain
colors <- NULL
return_plot <- Sys.getenv("RETURN_PLOT")
filename <- "fig_academics.svg"

# Make dotplot
bwu::dotplot(
  data = data,
  x = x,
  y = y,
  colors = colors,
  return_plot = return_plot,
  filename = filename
)
```

```{=typst}
#let domain(title: none, file_qtbl, file_fig) = {
  let font = (font: "Fira Sans", size: 9pt)
  set text(..font)
    grid(
      columns: (50%, 50%),
      gutter: 8pt,
        figure([#image(file_qtbl)],
          caption: figure.caption(position: top, [#title]),
          kind: "qtbl",
          supplement: [*Table*],
          ),
        figure([#image(file_fig, width: auto)],
          caption: figure.caption(position: bottom, [
            _Reading ability_ consists of three interrelated abilities: decoding, comprehension, and fluency. _Writing ability_ can be described in terms of spelling, grammar, expression of ideas, and writing fluency. _Math ability_ can be described in terms of calculation skills, applied problem solving, and math fluency.
            ]),
          placement: none,
          kind: "image",
          supplement: [*Fig.*],
          gap: 0.5em,
          ),
      )
  }
```

```{=typst}
#let title = "Academic Achievement"
#let file_qtbl = "table_academics.png"
#let file_fig = "fig_academics.svg"
#domain(
  title: [#title Test Scores],
  file_qtbl,
  file_fig,
  )
```
